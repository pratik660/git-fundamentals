This is a resolved version combining main and feature branch.

